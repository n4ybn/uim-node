

<div class="row">
    <h3>Subscribers</h3>
</div>
<div class="row">
    <div class="col-md-8 the-box full no-border">
        <div class="table-responsive">
            <table id="subscribers" class="table table-th-block table-dark dataTable">
                <thead>
                <tr><th style="width: 120px;">Hub</th><th>Queue</th><th>Subject</th><th>Type</th><th>Connected</th><th>From</th><th>Bulk Size</th></tr>
                </thead>
                <tbody>

                </tbody>
            </table>
        </div><!-- /.table-responsive -->
    </div>
</div>

<script>

    // Subscriber List
    var subscriberstable = $('#subscribers').DataTable({
        "pageLength": 100,
        "autowidth": true
    });

    var subscriberlist;

    function updateSubscribersList(list) {
        subscriberlist = list;
        var name ="", id ="", type ="", connected ="", subject ="", bulksize ="", from ="", address ="", remote_queue ="";
        for (var i = 0; i < subscriberlist.length; i++) {
            //loop through the nimInt table
            for (var j = 0; j < subscriberlist[i].nimInt.length; j++) {
                var key = subscriberlist[i].nimInt[j]['@key'];
                var value = subscriberlist[i].nimInt[j]['$']
                if (key === "bulk_size") {
                    bulksize = value;
                }

            };

            //loop through the nimString table
            for (var k = 0; k < subscriberlist[i].nimString.length; k++) {
                key = subscriberlist[i].nimString[k]['@key'];
                value = subscriberlist[i].nimString[k]['$']
                switch(key) {
                    case "name":
                        name = value;
                        break;
                    case "connected":
                        connected = value;
                        break;
                    case "id":
                        id = value;
                        break;
                    case "type":
                        type = value;
                        break;
                    case "subject":
                        subject = value;
                        break;
                    case "from":
                        from = value;
                        break;
                    case "address":
                        address = value;
                        break;
                    case "remote_queue":
                        remote_queue = value;
                        break;
                };
            };
            subscriberstable.row.add( [ localStorage.getItem("primaryhubaddress"),name,subject,type,connected,from,bulksize ] );
        };
        subscriberstable.draw();
    }

    hub.getSubscribers(updateSubscribersList);

</script>